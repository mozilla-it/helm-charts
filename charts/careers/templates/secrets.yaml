{{- if .Values.externalSecrets.enabled -}}
apiVersion: kubernetes-client.io/v1
kind: ExternalSecret
metadata:
  name: {{ include "careers.fullname" . }}
spec:
  backendType: secretsManager
  dataFrom:
  - {{ .Values.externalSecrets.secretName }}
---
apiVersion: kubernetes-client.io/v1
kind: ExternalSecret
metadata:
  name: {{ include "careers.fullname" . }}-hook
  annotations:
    "helm.sh/hook": pre-install,pre-upgrade
    "helm.sh/hook-weight": "-10"
    "helm.sh/hook-delete-policy": before-hook-creation,hook-succeeded
spec:
  backendType: secretsManager
  dataFrom:
  - {{ .Values.externalSecrets.secretName }}
{{- else }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "careers.fullname" . }}
data:
  PG_NAME: Y2FyZWVycw==
  PG_USER: Y2FyZWVycw==
  PG_PASSWORD: ZGVmYXVsdHBhc3N3b3Jk
  PG_HOST: cG9zdGdyZXM=
  PG_PORT: NTQzMg==
  SECRET_KEY: dGhpcy1pcy1ub3QtdGhlLXByb2R1Y3Rpb24tdmFsdWU=
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "careers.fullname" . }}-hook
  annotations:
    "helm.sh/hook": pre-install,pre-upgrade
    "helm.sh/hook-weight": "-10"
    "helm.sh/hook-delete-policy": hook-succeeded
data:
  PG_NAME: Y2FyZWVycw==
  PG_USER: Y2FyZWVycw==
  PG_PASSWORD: ZGVmYXVsdHBhc3N3b3Jk
  PG_HOST: cG9zdGdyZXM=
  PG_PORT: NTQzMg==
  SECRET_KEY: dGhpcy1pcy1ub3QtdGhlLXByb2R1Y3Rpb24tdmFsdWU=
{{- end }}

